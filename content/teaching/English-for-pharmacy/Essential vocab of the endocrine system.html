<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thẻ Ghi Nhớ Nội Tiết</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Cấu hình Tailwind CSS
        tailwind.config = {"theme":{"extend":{"colors":{"primary":"#007AFF","secondary":"#34C759","accent":"#FF9500","destructive":"#FF3B30","macos_bg_light":"#F6F6F6","macos_bg_dark":"#2D2D2D","macos_secondary_bg_light":"#FFFFFF","macos_secondary_bg_dark":"#3C3C3C","macos_tertiary_bg_light":"#EFEFEF","macos_tertiary_bg_dark":"#232323","macos_label_light":"#000000","macos_label_dark":"#FFFFFF","macos_secondary_label_light":"rgba(60, 60, 67, 0.6)","macos_secondary_label_dark":"rgba(235, 235, 245, 0.6)","macos_separator_light":"rgba(60, 60, 67, 0.15)","macos_separator_dark":"rgba(84, 84, 88, 0.4)","macos_placeholder_light":"rgba(60, 60, 67, 0.3)","macos_placeholder_dark":"rgba(235, 235, 245, 0.3)","macos_control_bg_light":"#FFFFFF","macos_control_bg_dark":"#5A5A5A","macos_control_border_light":"#CCCCCC","macos_control_border_dark":"#4A4A4A"}}},"darkMode":"class"}
    </script>
    <style>
        /* CSS cho hiệu ứng lật thẻ */
        .flashcard-perspective {
            perspective: 1000px;
        }
        #flashcard-inner.is-flipped {
            transform: rotateY(180deg);
        }
        /* Đảm bảo các nút có thể nhấp được */
        .standalone-actions button {
            pointer-events: auto !important;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        }
    </style>
</head>
<body class="p-4 sm:p-6 bg-macos_bg_light dark:bg-macos_bg_dark text-macos_label_light dark:text-macos_label_dark font-sans">
    <h1 class="text-3xl font-bold text-center mb-6">Thẻ Ghi Nhớ Thuật Ngữ Nội Tiết</h1>
    <div id="standalone-activity" class="max-w-4xl mx-auto bg-macos_secondary_bg_light dark:bg-macos_secondary_bg_dark p-4 sm:p-6 rounded-lg shadow-lg">
        
        <div class="flashcard-container p-4 bg-macos_tertiary_bg_light dark:bg-macos_tertiary_bg_dark rounded-lg border border-macos_separator_light dark:border-macos_separator_dark flex flex-col items-center gap-4">

            <!-- Wrapper cho hiệu ứng 3D -->
            <div class="flashcard-perspective w-full aspect-[3/2] sm:w-4/5 md:w-3/4 lg:w-2/3">
                <!-- Phần tử xoay -->
                <div id="flashcard-inner" class="relative w-full h-full text-center transition-transform duration-700 ease-in-out cursor-pointer" style="transform-style: preserve-3d;">

                    <!-- Mặt trước -->
                    <div id="flashcard-front" class="flashcard-face absolute w-full h-full flex items-center justify-center p-6 bg-macos_secondary_bg_light dark:bg-macos_tertiary_bg_dark rounded-xl shadow-md border border-macos_separator_light dark:border-macos_separator_dark" style="backface-visibility: hidden;">
                        <div class="flashcard-text text-lg sm:text-xl md:text-2xl font-medium" aria-live="polite">
                            Đang tải...
                        </div>
                    </div>

                    <!-- Mặt sau -->
                    <div id="flashcard-back" class="flashcard-face absolute w-full h-full flex items-center justify-center p-6 bg-macos_secondary_bg_light dark:bg-macos_tertiary_bg_dark rounded-xl shadow-md border border-macos_separator_light dark:border-macos_separator_dark" style="backface-visibility: hidden; transform: rotateY(180deg);">
                         <div class="flashcard-text text-lg sm:text-xl md:text-2xl font-medium" aria-live="polite">
                             Đang tải...
                         </div>
                    </div>

                </div> <!-- Kết thúc #flashcard-inner -->
            </div> <!-- Kết thúc .flashcard-perspective -->


            <!-- Khu vực điều khiển -->
            <div class="flashcard-controls w-full flex justify-between items-center pt-4 mt-4 border-t border-macos_separator_light dark:border-macos_separator_dark">
                <button id="flashcard-prev-btn" class="px-4 py-2 text-base bg-white dark:bg-gray-600 hover:bg-gray-100 dark:hover:bg-gray-500 rounded-lg border border-gray-300 dark:border-gray-500 shadow-sm disabled:opacity-50 disabled:cursor-not-allowed transition-colors" aria-label="Thẻ trước">
                    &lt; Trước
                </button>
                <span id="flashcard-status" class="text-base font-medium text-macos_secondary_label_light dark:text-macos_secondary_label_dark">
                    Thẻ ? / ?
                </span>
                <button id="flashcard-next-btn" class="px-4 py-2 text-base bg-white dark:bg-gray-600 hover:bg-gray-100 dark:hover:bg-gray-500 rounded-lg border border-gray-300 dark:border-gray-500 shadow-sm disabled:opacity-50 disabled:cursor-not-allowed transition-colors" aria-label="Thẻ kế tiếp">
                    Sau &gt;
                </button>
            </div>
             <!-- Nút Lật Thẻ -->
             <button id="flashcard-flip-btn" class="mt-4 w-full sm:w-auto px-6 py-2.5 text-base font-semibold text-white bg-primary hover:bg-blue-600 rounded-lg shadow-md transition-transform transform hover:scale-105">Lật Thẻ</button>

        </div>
    
    </div>

    <script type="module">
    // --- Logic chính của ứng dụng Thẻ Ghi Nhớ ---

    /**
     * Thêm tương tác: hiển thị thẻ, xử lý lật và điều hướng.
     * @param {HTMLElement} activityElement - Phần tử chứa HTML của hoạt động.
     * @param {object} state - Đối tượng trạng thái chứa `state.cards`.
     */
    function addInteractivity(activityElement, state) {
        if (!activityElement || !state || !state.cards || state.cards.length === 0) {
            console.warn("FlashCards: Không thể thêm tương tác - thiếu phần tử hoặc dữ liệu thẻ.");
            return;
        }

        const cards = state.cards;
        let currentCardIndex = 0;

        // Lấy tham chiếu đến các phần tử UI
        const cardInner = activityElement.querySelector('#flashcard-inner');
        const frontFaceContent = activityElement.querySelector('#flashcard-front .flashcard-text');
        const backFaceContent = activityElement.querySelector('#flashcard-back .flashcard-text');
        const prevButton = activityElement.querySelector('#flashcard-prev-btn');
        const nextButton = activityElement.querySelector('#flashcard-next-btn');
        const statusDisplay = activityElement.querySelector('#flashcard-status');
        const flipButton = activityElement.querySelector('#flashcard-flip-btn');

        if (!cardInner || !frontFaceContent || !backFaceContent || !prevButton || !nextButton || !statusDisplay || !flipButton) {
            console.error("FlashCards: Lỗi cài đặt tương tác - thiếu các phần tử cốt lõi.");
            return;
        }
        
        // Hàm cập nhật văn bản trạng thái
        function updateStatus() {
            if (!statusDisplay) return;
            const isFlipped = cardInner.classList.contains('is-flipped');
            statusDisplay.textContent = `Thẻ ${currentCardIndex + 1} / ${cards.length} - ${isFlipped ? 'Mặt sau' : 'Mặt trước'}`;
        }

        // Hàm hiển thị nội dung của một thẻ cụ thể
        function displayCardContent(index) {
            if (index < 0 || index >= cards.length) return; // Chỉ số ngoài phạm vi

            const card = cards[index];
            currentCardIndex = index;

            // Cập nhật nội dung văn bản trên cả hai mặt
            frontFaceContent.textContent = card.front;
            backFaceContent.textContent = card.back;
            
            // Luôn quay về mặt trước khi chuyển thẻ
            cardInner.classList.remove('is-flipped');

            updateStatus();

            // Cập nhật trạng thái các nút điều hướng
            prevButton.disabled = (index === 0);
            nextButton.disabled = (index === cards.length - 1);
        }

        // Hàm xử lý việc lật thẻ
        function flipCard() {
            if (!cardInner) return;
            cardInner.classList.toggle('is-flipped');
            updateStatus();
        }
        
        // --- Gán các sự kiện ---
        flipButton.addEventListener('click', flipCard);
        // Cho phép nhấp vào chính thẻ để lật
        cardInner.addEventListener('click', flipCard);

        prevButton.addEventListener('click', (e) => {
            e.stopPropagation(); // Ngăn việc lật thẻ khi nhấp vào nút
            displayCardContent(currentCardIndex - 1);
        });

        nextButton.addEventListener('click', (e) => {
            e.stopPropagation(); // Ngăn việc lật thẻ khi nhấp vào nút
            displayCardContent(currentCardIndex + 1);
        });

        // Điều hướng bằng bàn phím
        document.addEventListener('keydown', (e) => {
             const isInputFocused = document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA';
             if (isInputFocused) return;

            if (e.key === 'ArrowLeft' && !prevButton.disabled) {
                 displayCardContent(currentCardIndex - 1);
            } else if (e.key === 'ArrowRight' && !nextButton.disabled) {
                 displayCardContent(currentCardIndex + 1);
            } else if (e.key === ' ' || e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault(); // Ngăn phím cách cuộn trang
                flipCard();
            }
         });

        // Hiển thị ban đầu
        displayCardContent(0);
    }
    
    // --- Logic khởi tạo ---
    document.addEventListener('DOMContentLoaded', () => {
        const activityHostElement = document.getElementById('standalone-activity');
        let state = null;

        if (!activityHostElement) { console.error("Không tìm thấy phần tử gốc của hoạt động."); return; }
        
        try {
            // Dữ liệu cho các thẻ ghi nhớ
            state = JSON.parse(`{"cards":[{"id":0,"front":"ACTH – Adrenocorticotropic Hormone","back":"Hormone hướng vỏ thượng thận"},{"id":1,"front":"GH – Growth Hormone","back":"Hormone tăng trưởng"},{"id":2,"front":"FSH – Follicle-Stimulating Hormone","back":"Hormone kích thích nang trứng"},{"id":3,"front":"TSH – Thyroid-Stimulating Hormone","back":"Hormone kích thích tuyến giáp"},{"id":4,"front":"MSH – Melanocyte-Stimulating Hormone","back":"Hormone kích thích tế bào hắc tố"},{"id":5,"front":"ADH – Antidiuretic Hormone","back":"Hormone chống bài niệu"},{"id":6,"front":"LH – Luteinizing Hormone","back":"Hormone hoàng thể hóa"},{"id":7,"front":"PTH – Parathyroid Hormone","back":"Hormone tuyến cận giáp"},{"id":8,"front":"T3 – Triiodothyronine","back":"Triiodothyronine"},{"id":9,"front":"T4 – Thyroxine","back":"Thyroxine"},{"id":10,"front":"PRL / LTH – Prolactin (Lactogenic Hormone)","back":"Prolactin (hormone tạo sữa)"},{"id":11,"front":"Hypothyroidism","back":"Suy giáp"},{"id":12,"front":"Hyperthyroidism","back":"Cường giáp"},{"id":13,"front":"Thyroid storm","back":"Cơn bão giáp"},{"id":14,"front":"Goiter / Thyromegaly","back":"Bướu giáp"},{"id":15,"front":"Hyperparathyroidism","back":"Cường cận giáp"},{"id":16,"front":"Hypoparathyroidism","back":"Suy cận giáp"},{"id":17,"front":"Diabetes insipidus (DI)","back":"Đái tháo nhạt"},{"id":18,"front":"Pancreatitis","back":"Viêm tụy"},{"id":19,"front":"Diabetes mellitus (DM)","back":"Đái tháo đường"},{"id":20,"front":"Gestational diabetes mellitus (GDM)","back":"Đái tháo đường thai kỳ"},{"id":21,"front":"Metabolic syndrome","back":"Hội chứng chuyển hóa"},{"id":22,"front":"Prediabetes","back":"Tiền đái tháo đường"},{"id":23,"front":"Insulin deficiency","back":"Thiếu insulin"},{"id":24,"front":"Insulin resistance","back":"Đề kháng insulin"},{"id":25,"front":"Diabetic ketoacidosis","back":"Nhiễm toan ceton do ĐTĐ"},{"id":26,"front":"Diabetic coma","back":"Hôn mê do ĐTĐ"},{"id":27,"front":"Fasting plasma glucose (FPG) test","back":"Xét nghiệm đường huyết lúc đói"},{"id":28,"front":"Oral glucose tolerance test (OGTT)","back":"Nghiệm pháp dung nạp glucose đường uống"},{"id":29,"front":"Diabetic retinopathy","back":"Bệnh võng mạc ĐTĐ"},{"id":30,"front":"Peripheral neuropathy","back":"Bệnh lý thần kinh ngoại biên"},{"id":31,"front":"Hyperglycemia","back":"Tăng đường huyết"},{"id":32,"front":"Hypoglycemia","back":"Hạ đường huyết"},{"id":33,"front":"Polydipsia","back":"Khát nhiều"},{"id":34,"front":"Polyphagia","back":"Ăn nhiều"},{"id":35,"front":"Polyuria","back":"Tiểu nhiều"},{"id":36,"front":"aden/o","back":"tuyến"},{"id":37,"front":"adren/o","back":"tuyến thượng thận"},{"id":38,"front":"crin/o","back":"bài tiết"},{"id":39,"front":"gluc/o, glyc/o","back":"đường, glucose"},{"id":40,"front":"hormon/o","back":"hormone"},{"id":41,"front":"pancreat/o","back":"tuyến tụy"},{"id":42,"front":"parathyroid/o","back":"tuyến cận giáp"},{"id":43,"front":"thyr/o, thyroid/o","back":"tuyến giáp"},{"id":44,"front":"toxic/o","back":"độc tố"},{"id":45,"front":"gonad/o","back":"tuyến sinh dục"},{"id":46,"front":"testic/o","back":"tinh hoàn"},{"id":47,"front":"ovari/o","back":"buồng trứng"},{"id":48,"front":"pineal/o","back":"tuyến tùng"},{"id":49,"front":"pituit/o, pituitar/o","back":"tuyến yên"},{"id":50,"front":"thym/o","back":"tuyến ức"},{"id":51,"front":"-crine","back":"tiết ra"},{"id":52,"front":"-dipsia","back":"khát"},{"id":53,"front":"-gen","back":"hình thành, nguồn gốc"},{"id":54,"front":"-toxic","back":"liên quan độc tố"},{"id":55,"front":"-uria","back":"nước tiểu"},{"id":56,"front":"Pituitary gland (anterior: ACTH, FSH, GH, LH, PRL, TSH; posterior: ADH, Oxytocin)","back":"Tuyến yên – điều hòa hầu hết tuyến khác"},{"id":57,"front":"Pineal gland","back":"Tuyến tùng - Tiết melatonin, điều hòa giấc ngủ"},{"id":58,"front":"Thyroid gland","back":"Tuyến giáp - T3, T4, Calcitonin – chuyển hóa, phát triển"},{"id":59,"front":"Parathyroid glands","back":"Tuyến cận giáp - PTH – điều hòa canxi"},{"id":60,"front":"Thymus gland","back":"Tuyến ức - Vai trò trong miễn dịch"},{"id":61,"front":"Adrenal glands (cortex: cortisol, aldosterone, sex hormones; medulla: epinephrine, norepinephrine)","back":"Tuyến thượng thận - Chuyển hóa, cân bằng điện giải, đáp ứng stress"},{"id":62,"front":"Pancreas (islets)","back":"Tuyến tụy - Insulin, glucagon – điều hòa glucose"},{"id":63,"front":"Ovaries","back":"Buồng trứng - Estrogen, progesterone, inhibin – sinh sản nữ"},{"id":64,"front":"Testes","back":"Tinh hoàn - Testosterone, inhibin – sinh sản nam"}]}`);
        } catch (parseError) {
            console.error("Lỗi phân tích JSON:", parseError);
            activityHostElement.innerHTML = '<p class="text-red-500 text-center">Lỗi: Không thể tải dữ liệu thẻ.</p>';
            return;
        }
        
        if (!state) { 
            console.error("Trạng thái là null sau khi phân tích.");
            activityHostElement.innerHTML = '<p class="text-red-500 text-center">Lỗi: Dữ liệu thẻ trống.</p>';
            return;
        }

        // Khởi tạo tương tác
        try {
            addInteractivity(activityHostElement, state);
            console.log("Khởi tạo thành công.");
        } catch (initError) {
            console.error("Lỗi trong quá trình khởi tạo tương tác:", initError);
            activityHostElement.innerHTML = '<p class="text-red-500 text-center">Lỗi: Không thể khởi tạo tương tác.</p>';
        }
    });
    </script>

</body>
</html>

